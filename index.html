<!DOCTYPE html>
<html lang="en">
  <head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link href="css/style.css" rel="stylesheet"> -->
  </head>
  <body>
  <div class="users" id="usersid">

  </div>




<script>

let randomUser; 
let fetchedUsers = [];

let userDiv = document.querySelector('.users');

window.onload = function() {
  fetchUser();
  setTimeout(function(){ attachToDom2(); }, 1000);
}

const fetchUser = async () => {
    const response = await fetch('https://randomuser.me/api/?results=5');
    const json = await response.json();
    console.log(json);
    console.log(json.results[0].name)
    console.log(`The first fetch Users is: ${json.results[0].name.first} ${json.results[0].name.last}`);
    console.log(`The first users picture is at: ${json.results[0].picture.large}`);
    fetchedUsers.push(json);
}

// function attachToDom2() {
//   fetchedUsers[0].results.forEach( 
//     function (element)  {
//       // name = fetchedUsers[0].results[0].name.first;
//       // last = fetchedUsers[0].results[0].name.last;
//       // picture = fetchedUsers[0].results[0].picture.medium;
      
//       console.log(element);

//       let name = element.name.first;
//       let last = element.name.last;
//       let picture = element.picture.large;
//       //extra info
//       let dob = element.dob.date;
//       let age = element.dob.age;
//       let address = element.location.street.name;
//       let addressNumber = element.location.street.number

//       let child = document.createElement('div');
      
//       child.innerHTML = `<p>
//           <img src="${picture}" />
//       ${name} ${last}
//       </p>

//       <button type="button" class="thisButton"> Additional Information </button>

//       <p style="display: none" class="additionalinfo">

//       Date of birth: ${dob}
//       Age: ${age}
//       Address: ${address} ${addressNumber}

//         </p>
//       `;

//       document.getElementById('usersid').appendChild(child);

//     })
// };

function attachToDom2() {
  fetchedUsers[0].results.forEach( 
    function (element)  {
      // name = fetchedUsers[0].results[0].name.first;
      // last = fetchedUsers[0].results[0].name.last;
      // picture = fetchedUsers[0].results[0].picture.medium;
      
      console.log(element);

      let name = element.name.first;
      let last = element.name.last;
      let picture = element.picture.large;
      //extra info
      let dob = element.dob.date;
      let age = element.dob.age;
      let address = element.location.street.name;
      let addressNumber = element.location.street.number

      // let child = document.createElement('div');

      let child = `<p>
          <img src="${picture}" />
      ${name} ${last}
      </p>

      <button onclick="handleClick()" type="button" class="thisButton" id="${name}"> Additional Information </button> 

<div class="addinfo" style="display: none">
      <p style="display: block" class="additionalinfo" id="${name}">

      Date of birth: ${dob}
      Age: ${age}
      Address: ${address} ${addressNumber}

        </p>
        </div>
      `;
      let myFragment = document.createRange().createContextualFragment(child);

      document.getElementById('usersid').appendChild(myFragment);
    })
};

// let userButton = document.querySelectorAll('.thisButton'); 
// userButton.addEventListener('click', handleClick);

function handleClick() {

  const buttonThatGotClicked = event.currentTarget;
  console.log(buttonThatGotClicked);
  var state = buttonThatGotClicked.nextElementSibling.style.display;

  if (state === "none") {
    buttonThatGotClicked.nextElementSibling.style.display = "block";
  } else {
    buttonThatGotClicked.nextElementSibling.style.display = "none";
  }

  // var x = buttonThatGotClicked.nextElementSibling;
  // if (x.style.display === "none") {
  //   x.style.display = "block";
  // } else {
  //   x.style.display = "none";
  // }

  // var x = buttonThatGotClicked.closest('.additionalinfo');
  // if (x.style.display === "none") {
  //   x.style.display = "block";
  // } else {
  //   x.style.display = "none";
  // }
// buttonThatGotClicked.closest('.additionalinfo').remove();

  // document.querySelectorAll(`.additionalinfo`).style.visibility= 'visible';
}

// setTimeout(function(){ let button = document.querySelectorAll('button.thisButton');  }, 2000);
//   setTimeout(function(){ button.addEventListener('click', handleClick);  }, 2500);

// function handleClick() {
//    console.log('🐛It got clicked!');
// }

// setTimeout(function(){ let button = document.querySelector('.additionalButton'); }, 500);
// setTimeout(function(){ button.addEventListener('click', handleClick); }, 500);
// setTimeout(function(){ button.addEventListener(function handleClick() {
//    console.log('🐛It got clicked!');
// }) }, 500);






// function attachToDom() {fetchedUsers[0].results.forEach(
//       element => userDiv.innerHTML =
//       `<p>
//       ${element}
//       </p>
//       `
//       );
// };

// function attachToDom2() {
//   fetchedUsers[0].results.forEach( 
//     function (name, last, picture)  {
//       name = fetchedUsers[0].results[0].name.first;
//       last = fetchedUsers[0].results[0].name.last;
//       picture = fetchedUsers[0].results[0].picture.medium;

//       userDiv.innerHTML =
//      `<p>
//       ${name} ${last}
//       </p>
//       <img src="${picture}" />
//       `
//     })
// };

// function generate(list) {
//     var out = '';

//     for (var i in list) {
//         var rec = list[i];
//         var row = [];

//         for (var field in rec) {
//             row.push(field + ': ' + rec[field]);
//         }

//         out += "<li>" + row.join(', ') + "</li>";
//     }

//     return "<ul>" + out + "</ul>";
// }




// const getRandomUser = () => {
//   fetch(`https://randomuser.me/api/`)
//     .then(res => res.json())
//     .then(posts => randomUser = posts)
// }

// setTimeout(function(){console.log(randomUser); }, 700);

</script>
  </body>
</html>